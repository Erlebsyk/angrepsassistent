'use strict'function proceed(){function e(){var e=document.getElementById("serverTime").innerHTML;V!=e&&setTimeout(function(){S=setInterval(t,A),clearInterval(D)},d+1)}function t(){h=Timing.getCurrentServerTime();var e=Math.round(b-h),t=a(e),n=document.getElementById("in_content");if(n.innerHTML=t,1==notificationState&&r>=b-h&&0==L){if(1==focusTabState)6e4==r?confirm(r/6e4+" Minute left to command excecution!"):confirm(r/6e4+" Minutes left to command excecution!");else{var i=window.open("","Alert","width=200, height=20");i.document.head.innerHTML="<link rel='stylesheet' type='text/css' href='https://dsno.innogamescdn.com/assets/no24/427980c4bd832083e2f85d5f5b9952c5/merged/game.css'>",6e4==r?i.document.body.innerHTML="<h4 class='tooltip-style' id='note'>"+r/6e4+" Minute left to command excecution!</h4>":i.document.body.innerHTML="<h4 class='tooltip-style' id='note'>"+r/6e4+" Minutes left to command excecution!</h4>"}L=1}0>=b-h&&(n=document.getElementById("in_content"),n.innerHTML="00:00:00:<span class='grey small'>000</span>",clearInterval(S),document.title="00:00:00")}function n(){var e=Number(document.getElementById("hour_input").value),t=Number(document.getElementById("minute_input").value),n=Number(document.getElementById("second_input").value),i=Number(document.getElementById("millisecond_input").value),o=checkH(e),a=checkM(t),c=checkM(n),d=checkMs(i);document.getElementById("date_arrival").parentNode.parentNode.parentNode.style.width="350px";var s="<span id='new_input_time'>| "+o+":"+a+":"+c+":<span class='grey small' id='new_input_milliseconds'>"+d+"</span></span>",r=document.createElement("span");return r.innerHTML=s,document.getElementById("date_arrival").appendChild(r.firstChild),36e5*e+6e4*t+1e3*n+i}function i(){var e=new Date,t=e.getUTCHours()+window.server_utc_diff/3600,n=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return 36e5*t+6e4*n+1e3*i+o+calibrationEstimate}function o(e){var t=new Date(e),n=t.getHours(),i=t.getMinutes(),o=t.getSeconds(),a=t.getMilliseconds();return n=checkH(n),i=checkM(i),o=checkM(o),a=checkMs(a),n+":"+i+":"+o+":<span class='grey small' id='send_ms'>"+a+"</span>"}function a(e){var t=Math.floor(e/36e5),n=Math.floor((e-36e5*t)/6e4),i=Math.floor((e-36e5*t-6e4*n)/1e3),o=e-36e5*t-6e4*n-1e3*i;return t=checkH(t),n=checkM(n),i=checkM(i),o=checkMs(o),document.title=t+":"+n+":"+i,t+":"+n+":"+i}var c=n(),d=Number(document.getElementById("millisecond_input").value),s=d.length,r=6e4*Number(document.getElementById("notification_input").value),l=checkMs(d,s),u=i(),m=c-u;Dialog.close(),0>m&&(m=864e5-u+c);var p=$(".relative_time").attr("data-duration"),h=(new Date).getTime(),b=h+m-1e3*p,f=o(b),y=document.getElementById("date_arrival").parentNode.rowIndex+5,g=document.createElement("TR"),v=document.createElement("TD");g.appendChild(v);var x=document.createTextNode("Send in:");v.appendChild(x);var _=document.createElement("TD"),T=document.createAttribute("id");T.value="in_content",_.setAttributeNode(T);var E=document.createTextNode("synchronizing clocks...");_.appendChild(E),g.appendChild(_);var k=document.getElementById("date_arrival").parentNode.parentNode;k.insertBefore(g,k.childNodes[y]);var M=document.createElement("TR"),w=document.createElement("TD");M.appendChild(w);var B=document.createTextNode("Send:");w.appendChild(B);var I=document.createElement("TD"),N=document.createAttribute("id");N.value="send_content",I.setAttributeNode(N);var C=document.createTextNode("");I.innerHTML=f,I.appendChild(C),M.appendChild(I);var H=document.getElementById("date_arrival").parentNode.parentNode;if(H.insertBefore(M,H.childNodes[y]),document.getElementById("send_ms").innerHTML=l,h>b)alert("Too late or too far away to arrive at the given time :'(");else var S,L=0,A=Timing.tick_interval,V=document.getElementById("serverTime").innerHTML,D=setInterval(e,1)}function calibrationF(){var e=Number(Timing.getCurrentServerTime())-Number((new Date).getTime());return e}function arriveDisplay(){var e=document.getElementsByName("hour")[0].value,t=document.getElementsByName("minute")[0].value,n=document.getElementsByName("second")[0].value,i=Math.round(document.getElementsByName("millisecond")[0].value),o=e.length,a=t.length,c=n.length,d=i.length;e=checkH(e,o),t=checkM(t,a),n=checkM(n,c),i=checkMs(i,d)}function checkH(e,t){return 0==t||t>2||e>23?e="00":(1==t||10>e)&&(e="0"+e),e}function checkM(e,t){return 0==t||t>2?e="00":1==t||10>e?e="0"+e:e>59&&(e="59"),e}function checkMs(e,t){return 0==t||t>3?e="000":1==t||10>e?e="00"+e:2==t||e>=10&&100>e?e="0"+e:e>999&&(e="999"),e}function notificationTest(){var e=window.open("","Alert","width=200, height=20");e.document.head.innerHTML="<link rel='stylesheet' type='text/css' href='https://dsno.innogamescdn.com/assets/no24/427980c4bd832083e2f85d5f5b9952c5/merged/game.css'>",e.document.body.innerHTML="<h4 class='tooltip-style' id='note'>Seems to be working!</h4>"}function windowSettings(){var e="<div class='popup_box_container'><div class='popup_box show' id='popup_box_help' style='width: 350px;'><div class='popup_box_content'><a class='popup_box_close tooltip-delayed' href='#' onclick='Dialog.close()'>&nbsp;</a><h2 class='popup_box_header'>Command Assistant</h2><td valign='top'><table class='vis' style='width:150px' background='https://dsno.innogamescdn.com/8.44.1/28623/graphic/index/main_bg.jpg'><tbody><tr><th>Time for arrival</th></tr><tr><td class='nowrap'><span>Hour:</span> <input value='' tabindex='1' style='width: 50px;float:right;margin-right:3px' type='number' name='hour' id='hour_input' max='23' min='0'> </td></tr><tr><td class='nowrap'><span>Minute:</span> <input id='minute_input' name='minute' type='number' style='width: 50px;float:right;margin-right:3px' tabindex='2' value='' max='59' min='0'> </td></tr><tr><td class='nowrap'><span>Second:</span> <input id='second_input' name='second' type='number' style='width: 50px;float:right;margin-right:3px' tabindex='3' value='' max='59' min='0'>\n</td></tr><tr><td class='nowrap'><span>Millisecond:</span> <input id='millisecond_input' name='millisecond' type='number' style='width: 50px;margin-right:3px;float:right' tabindex='4' value='' max='999' min='0'></td></tr></tbody></table><table class='vis' style='width:300px' background='https://dsno.innogamescdn.com/8.44.1/28623/graphic/index/main_bg.jpg'><tbody><tr><th>Command options</th></tr><tr><td class='nowrap'><input type='checkbox' id='notification_checkbox' tabindex='6'><span>Enable notifications</span></td></tr><tr><td class='nowrap'><span id='notification_text'>Minutes to notify before command:</span><input id='notification_input' name='notificationInput' type='number' style='width: 35px;float:right;margin-right:3px' tabindex='5' value='1' max='60' min='0'></td></tr><tr><td class='nowrap'><input type='checkbox' id='focus_tab_checkbox' tabindex='7'><span id='autofocus_text'>Automaticly focus tab on notification</span></td></tr></tbody></table><br><button id=confirmBtn class='btn'>Confirm</button><br><br><p class='tooltip-style' id='note' style='position:relative;visibility:hidden;'><strong>Note:</strong> Some browsers may require permission for popups. If notifications is enabled, make sure your browser have the right permission to display these. Test notifications here: <strong><test id='popup_test' style='color:black;' onmouseover='mOver()' onmouseout='mOut()'>here</test></strong></p></div></div><div class='fader'></div></div>",t=document.createElement("div");t.innerHTML=e,document.getElementById("ds_body").appendChild(t.firstChild),document.getElementById("note").style.display="hidden",document.getElementById("confirmBtn").addEventListener("click",arriveDisplay),document.getElementById("confirmBtn").addEventListener("click",proceed),document.getElementById("notification_text").setAttributeNode(notificationVisibility),document.getElementById("autofocus_text").setAttributeNode(focusTabVisibility),document.querySelector("#notification_checkbox").addEventListener("change",notificationCheckbox),document.querySelector("#focus_tab_checkbox").addEventListener("change",focusTabCheckbox),document.getElementById("popup_test").addEventListener("click",notificationTest)}function notificationCheckbox(){notification_checkbox.checked?(notificationState=1,notificationVisibility.value="visible",focusTabVisibility.value="visible",document.getElementById("note").style.visibility="visible",document.getElementById("autofocus_text").setAttributeNode(notificationVisibility),document.getElementById("notification_text").setAttributeNode(notificationVisibility)):(notificationState=0,notificationVisibility.value="hidden",focusTabVisibility.value="hidden",document.getElementById("note").style.visibility="hidden",document.getElementById("autofocus_text").setAttributeNode(notificationVisibility),document.getElementById("notification_text").setAttributeNode(notificationVisibility))}function focusTabCheckbox(){focusTabState=focus_tab_checkbox.checked?1:0}function mOver(){document.getElementById("popup_test").style.color="red"}function mOut(){document.getElementById("popup_test").style.color="black"}var calibrationEstimate=calibrationF(),focusTabState,notificationState,notificationVisibility=document.createAttribute("class"),focusTabVisibility=document.createAttribute("class");notificationVisibility.value="hidden",focusTabVisibility.value="hidden",windowSettings();
